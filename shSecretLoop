--// Configuración
_G.tplayer = "Habbathehut" -- Aquí pones tu nick (la cuenta líder)
getgenv().loopgoto = true

--// Servicios
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local player = Players.LocalPlayer

--// Offsets para cada cuenta (arriba, derecha, izquierda, atrás, adelante)
-- Cada cuenta usará un offset diferente para no chocar
local offsets = {
    Vector3.new(0, 3, 0),   -- encima
    Vector3.new(3, 0, 0),   -- derecha
    Vector3.new(-3, 0, 0),  -- izquierda
    Vector3.new(0, 0, 3),   -- detrás
    Vector3.new(0, 0, -3),  -- delante
}

-- Asignar offset por UserId (cada cuenta tendrá uno distinto)
local function getOffset()
    local uid = player.UserId
    local index = (uid % #offsets) + 1
    return offsets[index]
end

local myOffset = getOffset()

--// No colisiones (para evitar empujones)
local function NoCollideCharacter(char)
	for _, part in pairs(char:GetDescendants()) do
		if part:IsA("BasePart") then
			part.CanCollide = false
		end
	end
	char.DescendantAdded:Connect(function(part)
		if part:IsA("BasePart") then
			part.CanCollide = false
		end
	end)
end

player.CharacterAdded:Connect(NoCollideCharacter)
if player.Character then
	NoCollideCharacter(player.Character)
end

--// Auto Follow con offsets
task.spawn(function()
	while getgenv().loopgoto do
		RunService.Heartbeat:Wait()
		pcall(function()
			local target = Players[_G.tplayer]
			if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
				local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
				if root then
					-- Posición segura con offset
					local targetPos = target.Character.HumanoidRootPart.CFrame * CFrame.new(myOffset)

					-- Suavizar movimiento
					root.CFrame = root.CFrame:Lerp(targetPos, 0.25)
				end
			end
		end)
	end
end)

--// Anti AFK
player.Idled:Connect(function()
	VirtualUser:Button2Down(Vector2.new(), workspace.CurrentCamera.CFrame)
	task.wait(1)
	VirtualUser:Button2Up(Vector2.new(), workspace.CurrentCamera.CFrame)
end)

--// Anti Lag
task.spawn(function()
	while task.wait(5) do
		pcall(function()
			for _, v in pairs(workspace:GetDescendants()) do
				if v:IsA("ParticleEmitter") or v:IsA("Trail") then
					v:Destroy()
				end
			end
			settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
			workspace.GlobalShadows = false
			workspace.ExtentsCullingEnabled = true
		end)
	end
end)
